"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),Input=function(){function e(){_classCallCheck(this,e),this.apiKey="",this.requestUrl="http://api.themoviedb.org/3",this.baseUrl="",this.trailerBase="https://www.youtube.com/results",this.posterSize=4,this.minVotes=50,this.minAverage=6,this.data={genres:{},years:{},ready:!0,result:!1,selected:{genres:[],year:!1,lesserKnown:!1,bad:!1},options:{genres:!1,years:!1,other:!1}}}return _createClass(e,[{key:"setBaseConfig",value:function(e){input.baseUrl=e.images.base_url,input.posterSize=e.images.poster_sizes[input.posterSize]}},{key:"populateGenres",value:function(e){var t={},i=!0,s=!1,a=void 0;try{for(var r,n=e.genres[Symbol.iterator]();!(i=(r=n.next()).done);i=!0){var u=r.value;t[u.id]=u.name}}catch(l){s=!0,a=l}finally{try{!i&&n["return"]&&n["return"]()}finally{if(s)throw a}}this.data.genres=t}},{key:"populateYears",value:function(){this.data.years={1940:"40s",1950:"50s",1960:"60s",1970:"70s",1980:"80s",2e3:"00s",2010:"10s"}}},{key:"convertSelection",value:function(){var e="";if(this.data.selected.genres.length>0&&(e+="&with_genres="+this.data.selected.genres.join("|")),this.data.selected.year){var t=parseInt(this.data.selected.year);e+="&primary_release_date.gte="+t+"-01-01&primary_release_date.lte="+(t+9)+"-12-31"}return this.data.selected.lesserKnown?(this.defaultVotes=this.minVotes,this.minVotes=10):this.defaultVotes&&(this.minVotes=this.defaultVotes),this.data.selected.bad?(this.defaultAverage=this.minAverage,this.minAverage=1):this.defaultAverage&&(this.minAverage=this.defaultAverage),e}},{key:"randomize",value:function(e){return Math.ceil(Math.random()*e)}},{key:"createPath",value:function(){this.data.result.backdrop_path&&(this.data.result.poster=this.baseUrl+input.posterSize+this.data.result.backdrop_path)}},{key:"setYear",value:function(){this.data.result.year=this.data.result.release_date.slice(0,4)}},{key:"setTrailer",value:function(){var e=this.data.result.title.replace(/\s/g,"+").toLowerCase();this.data.result.trailer=this.trailerBase+"?search_query="+e+"+"+this.data.result.year+"+trailer"}}]),e}(),input=new Input;!function(){new Vue({el:"#app",data:input.data,ready:function(){this.$http.get(input.requestUrl+"/configuration?api_key="+input.apiKey,function(e){input.setBaseConfig(e)}),this.$http.get(input.requestUrl+"/genre/movie/list?api_key="+input.apiKey,function(e){input.populateGenres(e)}),input.populateYears()},methods:{activeGenre:function(e){return-1!=this.selected.genres.indexOf(e)},activeYear:function(e){return e==this.selected.year},active:function(e){return e==this.selected[e]},filterGenre:function(e){this.activeGenre(e)?this.selected.genres.splice(this.selected.genres.indexOf(e),1):this.selected.genres.push(e)},filterYear:function(e){this.activeYear(e)?this.selected.year=!1:this.selected.year=e},filter:function(e){this.active(e)?this.selected[e]=!1:this.selected[e]=e},recommend:function(){this.result={};var e=input.convertSelection(),t=input.requestUrl+"/discover/movie?api_key="+input.apiKey+e+"&vote_count.gte="+input.minVotes+"&vote_average.gte="+input.minAverage;this.$http.get(t,function(e){var i=input.randomize(e.total_pages);this.$http.get(t+"&page="+i,function(e){var t=input.randomize(e.results.length)-1;this.result=e.results[t],input.createPath(),input.setYear(),input.setTrailer()})})}}})}();